spring:
  application:
    name: actuator-deep-dive

server:
  port: 8080

# Actuator 설정
management:
  # 엔드포인트 기본 경로 (기본값: /actuator)
  endpoints:
    web:
      base-path: /actuator
      exposure:
        # 노출할 엔드포인트 목록
        include:
          - health
          - info
          - metrics
          - prometheus
          - env
          - beans
          - mappings
          - configprops
          - loggers
          - threaddump
          - heapdump
          - custom
          - cache-stats

  # Health 엔드포인트 상세 설정
  endpoint:
    health:
      # 상세 정보 표시 (항상 표시)
      show-details: always
      # 개별 HealthIndicator 표시
      show-components: always
      # Liveness/Readiness probe 활성화 (Kubernetes)
      probes:
        enabled: true

    # 환경 변수 중 민감한 정보 마스킹
    env:
      show-values: when-authorized

  # 메트릭 설정
  metrics:
    # 태그 추가 (모든 메트릭에 공통으로 적용)
    tags:
      application: ${spring.application.name}
      environment: dev

    # 분포 통계 활성화 (히스토그램, 백분위수)
    distribution:
      percentiles-histogram:
        http.server.requests: true
      percentiles:
        http.server.requests: 0.5, 0.95, 0.99
      slo:
        http.server.requests: 100ms, 200ms, 500ms

  # 정보 엔드포인트
  info:
    env:
      enabled: true
    java:
      enabled: true
    os:
      enabled: true

# 애플리케이션 정보 (info 엔드포인트에 노출)
info:
  app:
    name: Actuator Deep Dive
    description: Production-ready features with Spring Boot Actuator
    version: 1.0.0
  team:
    name: Backend Team
    email: backend@example.com

# 로깅 레벨
logging:
  level:
    root: INFO
    com.example.actuator: DEBUG
    org.springframework.boot.actuate: DEBUG

---
# 프로덕션 프로파일
spring:
  config:
    activate:
      on-profile: prod

management:
  endpoints:
    web:
      exposure:
        # 프로덕션에서는 최소한의 엔드포인트만 노출
        include:
          - health
          - info
          - prometheus

  endpoint:
    health:
      # 프로덕션에서는 인증된 사용자에게만 상세 정보 표시
      show-details: when-authorized

logging:
  level:
    root: WARN
    com.example.actuator: INFO
